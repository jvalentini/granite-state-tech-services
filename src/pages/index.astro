---
import BaseLayout from '../layouts/BaseLayout.astro';
import BookingEmbed from '../components/BookingEmbed.astro';
import { getCollection } from 'astro:content';
import { BOOKING_URL } from '../consts';

const posts = (await getCollection('blog'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---
<BaseLayout
  title="Granite State Tech Services"
  description="AI workshops, SEO strategy, and websites that convert for New Hampshire businesses."
>
  <section class="hero">
    <p class="eyebrow">New Hampshire's growth partner for service businesses</p>
    <h1>More booked calls.<br>Less guesswork.</h1>
    <p class="hero-subhead">
      Whether you need a website that converts, search rankings that drive calls,
      or a team that actually uses AI — we build the system that gets your phone ringing.
    </p>
    <div class="hero-actions">
      <a class="btn btn-primary btn-xl" href={BOOKING_URL}>Book your free strategy call</a>
      <a class="btn btn-ghost" href="#choose-your-path">See how we help</a>
    </div>
  </section>

  <section class="trust-bar">
    <div class="trust-items">
      <span>NH-based and founder-operated</span>
      <span class="trust-divider"></span>
      <span>50+ workshops delivered</span>
      <span class="trust-divider"></span>
      <span>Conversion-focused, not vanity metrics</span>
    </div>
  </section>

  <section id="choose-your-path" class="paths">
    <div class="paths-header">
      <p class="eyebrow">Choose your starting point</p>
      <h2>What's the biggest bottleneck<br>in your growth right now?</h2>
      <p class="paths-subhead">
        Every business we work with has a different starting point. Pick the one that
        sounds most like you — each leads to a focused plan built around your specific situation.
      </p>
    </div>

    <div class="path-grid">
      <a href="/web-design/" class="path-card surface">
        <span class="path-number">01</span>
        <h3>"My website isn't bringing in leads."</h3>
        <p>
          Your site looks fine, but nobody books through it. Visitors land, look around, and leave.
          You need a site built to convert — not just exist.
        </p>
        <ul class="path-list">
          <li>Conversion-focused design</li>
          <li>Built-in booking</li>
          <li>SEO-ready from day one</li>
        </ul>
        <span class="path-link">Explore web design <span class="arrow">&rarr;</span></span>
      </a>

      <a href="/seo/" class="path-card surface">
        <span class="path-number">02</span>
        <h3>"People can't find us on Google."</h3>
        <p>
          You know your services are good, but when locals search for what you do, your
          competitors show up first. You need to own the searches that lead to calls.
        </p>
        <ul class="path-list">
          <li>Local keyword targeting</li>
          <li>Google Business optimization</li>
          <li>Content that ranks and converts</li>
        </ul>
        <span class="path-link">Explore SEO services <span class="arrow">&rarr;</span></span>
      </a>

      <a href="/ai-workshops/" class="path-card surface">
        <span class="path-number">03</span>
        <h3>"My team wastes hours on repetitive work."</h3>
        <p>
          You've heard AI can help, maybe even tried ChatGPT a few times. But nobody on your
          team has built it into their actual workflow. You need a system, not a subscription.
        </p>
        <ul class="path-list">
          <li>Hands-on workshop training</li>
          <li>Custom prompt playbooks</li>
          <li>Measurable time savings</li>
        </ul>
        <span class="path-link">Explore AI workshops <span class="arrow">&rarr;</span></span>
      </a>
    </div>
  </section>

  <section class="narrative">
    <div class="story-card surface">
      <h2>The problem with most agencies</h2>
      <p>
        They sell you on vanity metrics. "We increased your traffic by 200%!" sounds great in a Zoom call.
        But when your phone still isn't ringing and your calendar stays empty, what good are those numbers?
      </p>
      <p>
        You don't need more traffic. You need more consultations. More signed contracts. More revenue.
      </p>
    </div>

    <div class="story-card surface highlight">
      <h2>What we optimize for</h2>
      <p>
        Every engagement centers on one metric: <strong>booked consultations per month</strong>.
        If a tactic doesn't drive bookings, we don't do it.
      </p>
    </div>
  </section>

  <section class="audience">
    <p class="eyebrow">Who this is for</p>
    <h2>Built for NH businesses that live and die by appointments</h2>
    <div class="audience-grid">
      <div class="audience-item">
        <strong>Attorneys and law firms</strong>
        <p>Turn search visibility into signed retainers.</p>
      </div>
      <div class="audience-item">
        <strong>Contractors and trades</strong>
        <p>Fill your calendar with qualified local jobs.</p>
      </div>
      <div class="audience-item">
        <strong>Healthcare practices</strong>
        <p>Grow patient volume with search and referrals.</p>
      </div>
      <div class="audience-item">
        <strong>Consultants and advisors</strong>
        <p>Build a pipeline that doesn't depend on referrals alone.</p>
      </div>
    </div>
  </section>

  <section class="trust">
    <h2>Why work with us</h2>
    <div class="card-grid">
      <div class="stat-card surface">
        <span class="stat-number">50+</span>
        <span class="stat-label">Workshops delivered</span>
      </div>
      <div class="stat-card surface">
        <span class="stat-number">NH</span>
        <span class="stat-label">Based and founder-operated</span>
      </div>
      <div class="stat-card surface">
        <span class="stat-number">&lt; 24hr</span>
        <span class="stat-label">Response time</span>
      </div>
    </div>
  </section>

  <section class="blog">
    <h2>Insights from the field</h2>
    <div class="card-grid">
      {posts.map((post) => (
        <article class="card">
          <p class="eyebrow">{post.data.tags?.[0] ?? 'Article'}</p>
          <h3>{post.data.title}</h3>
          <p>{post.data.description}</p>
          <a class="btn btn-ghost" href={`/blog/${post.slug}`}>Read more &rarr;</a>
        </article>
      ))}
    </div>
  </section>

  <section class="final-cta surface">
    <div>
      <h2>Let's get your phone ringing.</h2>
      <p>
        Book a 45-minute strategy call. I'll assess your current conversion path, show you where you're
        losing leads, and give you three clear options to fix it.
      </p>
      <p class="guarantee">
        No pitch deck. No upselling. Just honest analysis and a clear recommendation.
      </p>
      <a class="btn btn-primary btn-xl" href={BOOKING_URL}>Schedule your call</a>
    </div>
    <BookingEmbed />
  </section>
</BaseLayout>

<style>
  .btn-xl {
    padding: 1.2rem 2.4rem;
    font-size: 1.1rem;
  }

  .hero {
    text-align: center;
    padding: var(--space-3xl) 0;
    margin: var(--space-2xl) 0 var(--space-xl);
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
    align-items: center;
  }

  .hero-subhead {
    max-width: 640px;
    font-size: 1.15rem;
    line-height: 1.7;
    color: var(--text-dim);
  }

  .hero-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-md);
    justify-content: center;
  }

  /* Trust bar */
  .trust-bar {
    text-align: center;
    margin: 0 0 var(--space-3xl);
  }

  .trust-items {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: var(--space-md) var(--space-lg);
    font-size: 0.9rem;
    color: var(--text-dim);
    letter-spacing: 0.01em;
  }

  .trust-divider {
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: var(--granite-300);
    flex-shrink: 0;
  }

  /* Persona paths */
  .paths {
    margin: var(--space-3xl) 0;
  }

  .paths-header {
    text-align: center;
    margin-bottom: var(--space-2xl);
  }

  .paths-subhead {
    max-width: 600px;
    margin: 0 auto;
    font-size: 1.05rem;
    line-height: 1.7;
  }

  .path-grid {
    display: grid;
    gap: var(--space-xl);
    grid-template-columns: repeat(3, 1fr);
  }

  .path-card {
    padding: var(--space-2xl);
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    text-decoration: none;
    color: inherit;
    transition: transform 200ms var(--ease-out), box-shadow 200ms var(--ease-out);
  }

  .path-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow);
  }

  .path-number {
    font-family: var(--font-display);
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--accent-secondary-strong);
    line-height: 1;
  }

  .path-card h3 {
    font-size: 1.3rem;
    line-height: 1.3;
    color: var(--text);
  }

  .path-card p {
    font-size: 0.95rem;
    line-height: 1.65;
  }

  .path-list {
    list-style: none;
    padding: 0;
    margin: var(--space-sm) 0 0;
    display: grid;
    gap: var(--space-xs);
  }

  .path-list li {
    font-size: 0.9rem;
    color: var(--text-muted);
    padding-left: 1.2rem;
    position: relative;
  }

  .path-list li::before {
    content: "+";
    position: absolute;
    left: 0;
    color: var(--accent-secondary-strong);
    font-weight: 700;
  }

  .path-link {
    margin-top: auto;
    font-weight: 600;
    font-size: 0.95rem;
    color: var(--accent);
    display: flex;
    align-items: center;
    gap: var(--space-xs);
  }

  .path-link .arrow {
    transition: transform 200ms var(--ease-out);
  }

  .path-card:hover .path-link .arrow {
    transform: translateX(4px);
  }

  /* Narrative */
  .narrative {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xl);
    margin: var(--space-3xl) 0;
  }

  .story-card {
    padding: var(--space-2xl);
    max-width: 900px;
    margin: 0 auto;
  }

  .story-card h2 {
    margin-bottom: var(--space-lg);
  }

  .story-card p {
    font-size: 1.1rem;
    line-height: 1.7;
  }

  .highlight {
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-strong) 100%);
    color: white;
  }

  .highlight h2,
  .highlight p,
  .highlight strong {
    color: white;
  }

  /* Audience */
  .audience {
    margin: var(--space-3xl) 0;
  }

  .audience h2 {
    margin-bottom: var(--space-2xl);
  }

  .audience-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: var(--space-xl);
  }

  .audience-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .audience-item strong {
    font-size: 1.05rem;
    color: var(--text);
  }

  .audience-item p {
    font-size: 0.95rem;
    margin: 0;
  }

  /* Trust */
  .trust {
    margin: var(--space-3xl) 0;
    text-align: center;
  }

  .trust h2 {
    margin-bottom: var(--space-2xl);
  }

  .stat-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xl);
  }

  .stat-number {
    font-family: var(--font-display);
    font-size: 2rem;
    font-weight: 700;
    color: var(--accent-secondary-strong);
  }

  .stat-label {
    font-size: 0.95rem;
    color: var(--text-dim);
  }

  /* Blog */
  .blog {
    margin: var(--space-3xl) 0;
  }

  .blog h2 {
    margin-bottom: var(--space-xl);
  }

  /* Final CTA */
  .final-cta {
    padding: var(--space-3xl);
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-3xl);
    align-items: start;
    margin: var(--space-3xl) 0;
  }

  .guarantee {
    font-style: italic;
    color: var(--text-dim);
    font-size: 0.95rem;
  }

  @media (max-width: 920px) {
    .path-grid,
    .final-cta {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 600px) {
    .trust-divider {
      display: none;
    }

    .trust-items {
      flex-direction: column;
      gap: var(--space-xs);
    }
  }
</style>
